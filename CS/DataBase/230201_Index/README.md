- [Index](#index)
  - [인덱스](#인덱스)
    - [Index의 장점과 단점](#index의-장점과-단점)
      - [장점](#장점)
      - [단점](#단점)
    - [인덱스 생성 전략](#인덱스-생성-전략)

# Index

## 인덱스

> 데이터베이스 분야에 있어서 테이블에 대한 동작의 속도를 높여주는 **자료 구조**

- 테이블 내의 1개의 컬럼 혹은 여러 개의 컬럼을 이용하여 생성될 수 있다.

- 고속의 검색 동작뿐만 아니라 레코드 접근과 관련 효율적인 순서 매김(정렬) 동작에 대한 기초를 제공한다.

- 인덱스를 저장하는 데 필요한 디스크 공간은 보통 테이블을 저장하는 데 필요한 디스크 공간보다 작다.
  
  - 테이블의 값 자체를 저장하는것이 아닌, `key-value` 형식으로 `index-table` 과 같이 "찾아가는 값"만 저장하기 때문이다.

- 여려가지 유형이 있지만 Balanced Tree Index(밸런스드 트리 인덱스) 구조가 많이 사용되며 그중 `B * TREE`와 `B + TREE`구조가 자주 사용된다.

- 특정 컬럼에 `Index`를 생성하면, 해당 컬럼의 데이터들을 정렬하여 별도의 메모리 공간에 데이터의 물리적 주소와 함께 저장된다.
  
  - **"정렬"** 된 상태로 저장되기 때문에 고속 검색에 능하다.

- `Table`을 생성하면, `MYD`, `MYI`,`FRM` 3개의 파일이 생성된다.
  
  - 이때 `MYI` 파일에 `Index` 정보가 저장된다.
  - `FRM` : 테이블 구조가 저장된 파일, `MYD` : 실제 데이터 파일

- `Index`가 적용된 테이블에 데이터 조작언어(Data Manipulation Language, DML)인  `INSERT`, `DELETE`, `UPDATE`을 실행할 경우 아래와 같은 작업이 진행된다.
  
  - `INSERT` :  새로운 데이터에 대한 `Index`가 추가된다.
    
    - 테이블 중간에 끼워넣는 경우, 수정이 발생한 이후의 `Index`들을 모두 수정한다.
  
  - `DELETE` :  삭제하는 데이터의 `Index`를 사용하지 않는다고 명시한다.
    
    - `TABLE`의 데이터가 `DELETE`되는 경우 데이터가 지워지고 해당 인덱스는 비워진다. 이후에 추가되는 데이터가 해당 인덱스를 채워넣는다.
  
  - `UPDATE` : 기존의 `Index`를 사용하지 않음 처리하고, 갱신된 데이터에 대해 새로운 인덱스를 추가한다.
    
    - 다시말해 `DELETE` 작업 후, `INSERT` 두개의 작업이 수행된다.
    
    - `TABLE`의 데이터가 `UPDATE`되는 경우 인덱스 자체는 `UPDATE`할 수 없다.

### Index의 장점과 단점

- 인덱싱(Indexing)으로 각 `Index`를 갖는 테이블의 가장 큰 장점은 **"데이터가 정렬"** 되어있다는 점이다.( = 정렬된 상태를 **항상 유지**하고 있다.)

- 이러한 특징으로 아래와 같은 장점과 단점을 갖는다.

#### 장점

- 조건 검색 `WHERE`절의 효율성
  
  - `WHERE` 구문으로 특정 조건의 데이터를 조회할때 조건의 맞는 데이터를 찾기 위해 레코드의 처음부터 끝까지 탐색(**풀 테이블 스캔,Full Table Scan)** 하는게 아닌 `Index`를 활용하여 정렬된 데이터로 조건에 해당되는 데이터를 부분적으로 빠르게 조회할 수 있다.
  
  - 인덱스를 활용한 탐색(**인덱스 테이블 스캔, Index Table Scan**)은 정렬된 테이블을 탐색하기 때문에 빠른 조건 조회가 가능하다.

- 정렬 `ORDER BY` 절의 효율성
  
  - 인덱싱을 통해 `ORDER BY`에 의한 정렬과정을 피할 수 있다.
  
  - 필연적으로 풀 스캔이 발생하는 정렬과정을 피할 수 있다는 건 자원 소모의 절감을 의미한다.

- `MIN`, `MAX`의 효율적 처리
  
  - 역시 인덱싱으로 정렬된 데이터에서는 최소값과 최대값을 풀스캔을 피하고 조회할 수 있다.

#### 단점

- `DML`에 취약하다.
  
  - `INSERT`, `UPDATE`, `DELETE`의 작업 과정과 같이 조작이 발생한다면 테이블 내의 모든 값을 다시 정렬해야한다.
  
  - 인덱스 테이블과 원본 테이블, 두개의 테이블에 수정 작업한다.

- 인덱스 스캔의 효용성
  
  - 100만개의 데이터에 조회를 위해 인덱싱 작업을 해놓는 건 옳지만, 100개의 데이터를 위해 인덱싱을 하는건 소잡는데 닭 칼을 사용하는 꼴이 될 수 있다.
  
  - 또한 테이블의 전체 데이터 중 15%이하의 데이터를 처리하는 경우에 적합하다.

- 인덱스 파일의 저장공간
  
  - 테이블을 생성할 시 인덱스가 발생하는 것과 같이, 인덱스는 인덱스 테이블로 따로 관리된다.
  
  - 이로 인해 데이터베이스의 10%에 해당하는 저장공간이 추가로 필요하므로 인덱싱에 소모되는 비용에 적절한 효과를 발휘할 수 있는가를 판단후 인덱싱을 진행해야 한다.

### 인덱스 생성 전략

- 효율적인 인덱스 사용을 위해서는 조건절에 호출 빈도가 잦은 컬럼을 인덱스로 생성하는 게 좋다.

- 기준이 되는 컬럼은 최대한 중복되지 않을 수록 효율적인 인덱싱이 가능하다.

- 아래와 같은 리스트를 고려하여 인덱싱을 진행하자.
  
  1. 조건절에 자주 사용하는 컬럼
  
  2. 항상 `=`으로 비교되는 컬럼
  
  3. 중복 데이터가 최소한인(분포도가 적절한) 컬럼
  
  4. `ORDER BY`의 기준에 자주 선택되는 컬럼
  
  5. `JOIN` 조건으로 자주 사용되는 컬럼

---

- 레퍼런스

> [인덱스 (데이터베이스) - 위키백과, 우리 모두의 백과사전](https://ko.wikipedia.org/wiki/%EC%9D%B8%EB%8D%B1%EC%8A%A4_(%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4))
> 
> [데이터베이스 - 위키백과, 우리 모두의 백과사전](https://ko.wikipedia.org/wiki/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4)
> 
> [[DB] 데이터베이스(DB) 인덱스(Index) 란 무엇인가?](https://choicode.tistory.com/27)
