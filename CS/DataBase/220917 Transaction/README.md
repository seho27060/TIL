- [Transaction](#transaction)
  - [íŠ¸ëœì­ì…˜](#íŠ¸ëœì­ì…˜)
    - [íŠ¸ëœì­ì…˜ì˜ ì²˜ë¦¬ê³¼ì •](#íŠ¸ëœì­ì…˜ì˜-ì²˜ë¦¬ê³¼ì •)
    - [íŠ¸ëœì­ì…˜ì˜ ì¡°ê±´(ACID)](#íŠ¸ëœì­ì…˜ì˜-ì¡°ê±´acid)
      - [ì›ìì„±(Atomicity)](#ì›ìì„±atomicity)
        - [ì›ìì„± ë³´ì¥](#ì›ìì„±-ë³´ì¥)
        - [savePoint](#savepoint)
      - [ì¼ê´€ì„±(Consistency)](#ì¼ê´€ì„±consistency)
      - [ê²©ë¦¬ì„±(Isolation)](#ê²©ë¦¬ì„±isolation)
        - [ê²©ë¦¬ì„±ì˜ ìˆ˜ì¤€](#ê²©ë¦¬ì„±ì˜-ìˆ˜ì¤€)
          - [READ UNCOMMITED](#read-uncommited)
          - [READ COMMITED](#read-commited)
          - [REPEATABLE READ](#repeatable-read)
          - [SERIALBLE](#serialble)
      - [ì§€ì†ì„±(Durability)](#ì§€ì†ì„±durability)
# Transaction

## íŠ¸ëœì­ì…˜

> ë°ì´í„°ë² ì´ìŠ¤ì˜ ìƒíƒœë¥¼ ë³€í™”ì‹œí‚¤ê¸° ìœ„í•´ ìˆ˜í–‰í•˜ëŠ” ì‘ì—… ë‹¨ìœ„
> 
> ìª¼ê°¤ ìˆ˜ ì—†ëŠ” ì—…ë¬´ ì²˜ë¦¬ì˜ ìµœì†Œ ë‹¨ìœ„
> íŠ¸ëœì­ì…˜ì„ í†µí•´ ë°ì´í„°ë² ì´ìŠ¤ì˜ ì™„ì „ì„±(intergrity) ìœ ì§€ë¥¼ í™•ì‹ 

- ìƒíƒœë¥¼ ë³€í™” = SQL ì§ˆì˜ì–´ë¥¼ í†µí•´ DBì— ì ‘ê·¼í•˜ëŠ” ê²ƒ
  
  - `SELECT` , `INSERT` , `DELETE` , `UPDATE`ì™€ ê°™ì€ ì‘ì—…

- ì‘ì—… ë‹¨ìœ„ = ì‚¬ìš©ìê°€ íŠ¹ì • ê¸°ëŠ¥ì˜ ìˆ˜í–‰ì„ ìœ„í•´ SQLì‘ì—…ì„ ë¬¶ëŠ” ë‹¨ìœ„

- ìª¼ê°¤ ìˆ˜ ì—†ëŠ” ì—…ë¬´ ì²˜ë¦¬ = ì—¬ëŸ¬ê°œì˜ í´ë¼ì´ì–¸íŠ¸ê°€ ì•¡ì„¸ìŠ¤í•˜ê±°ë‚˜, DBë¥¼ ê°±ì‹  ì²˜ë¦¬í•˜ëŠ” ê³¼ì •ì—ì„œ ì¤‘ë‹¨ë˜ëŠ” ê²½ìš° ë°ì´í„° ë¶€ì •í•©ì„ ë°©ì§€í•˜ê¸° ìœ„í•œ ìµœì†Œ ì‘ì—… ë‹¨ìœ„

- ì™„ì „ì„±(intergrinity) ìœ ì§€ = ì‚¬ìš©ì A ì™€ ì‚¬ìš©ì Bê°€ 10,000ì›ì„ ì†¡ê¸ˆí•˜ëŠ” ì‘ì••ì´ ë°œìƒí• ë•Œ, ì‚¬ìš©ì Aì˜ ê³„ì¢Œì—ëŠ” 10,000ì› ë§Œí¼ ì°¨ê°ë˜ê³  Bì˜ ê³„ì¢Œì—ëŠ” 10,000ì›ì´ ì¶”ê°€ëœë‹¤. Aì˜ ê³„ì¢Œì—ì„œ ì†¡ê¸ˆí•˜ëŠ” ê³¼ì •ì— ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì„ ë•Œ, ì‘ì—…ì€ ì·¨ì†Œ(**rollback**)ë˜ì§€ë§Œ Bì˜ ê³„ì¢Œì—ëŠ” ê·¸ëŒ€ë¡œ 10,000ì›ì´ ì¶”ê°€(**commit**)ë  ìˆ˜ ìˆë‹¤. ì´ëŸ¬í•œ ìƒí™©ì—ì„œ DBì˜ ë°ì´í„° ë¶ˆì¼ì¹˜ê°€ ë‚˜íƒ€ë‚  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì™„ì •ì„± ìœ ì§€ë¥¼ ìœ„í•´ íŠ¸ëœì­ì…˜ì´ í•„ìš”í•˜ë‹¤.
  
  - rollback : SQL ì²˜ë¦¬ë¥¼ ì²˜ë¦¬ ì´ì „ì˜ ìƒíƒœë¡œ ë˜ëŒë¦°ë‹¤.
  
  - commit : SQL ì²˜ë¦¬ë¥¼ DBì— ë°˜ì˜í•œë‹¤.

### íŠ¸ëœì­ì…˜ì˜ ì²˜ë¦¬ê³¼ì •

1. Begin the transaction

2. Excute several quries - SQLì§ˆì˜ë“¤ì´ íŠ¸ëœì­ì…˜ì— ì €ì¥ëœë‹¤. DB ë‚´ ê°±ì‹ ì´ ì•„ì§ ì ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤.

3. Commit the transaction - íŠ¸ëœì­ì…˜ì´ ì„±ê³µì ì´ë©°, DB ê°±ì‹ ì´ ì‹¤ì œ ì ìš©ëœë‹¤.
- ë§Œì•½ 2.ì˜ ê³¼ì •ì¤‘ SQL ì¿¼ë¦¬ í•˜ë‚˜ê°€ ì‹¤íŒ¨í•˜ë©´, ë°ì´í„°ë² ì´ìŠ¤ ì‹œìŠ¤í…œì€ ì „ì²´ íŠ¸ëœì­ì…˜ ë˜ëŠ” ì‹¤íŒ¨í•œ ì¿¼ë¦¬ë¥¼ rollback í•œë‹¤.

### íŠ¸ëœì­ì…˜ì˜ ì¡°ê±´(ACID)

- íŠ¸ëœì­ì…˜ì´ ì‹¤í–‰ë˜ê¸° ìœ„í•´ëŠ” ACIDë¼ëŠ” 4ê°€ì§€ì˜ íŠ¹ì„±ì„ ë§Œì¡±í•´ì•¼ í•œë‹¤.

#### ì›ìì„±(Atomicity)

- íŠ¸ëœì­ì…˜ ë‚´ë¶€ì—ì„œ ì‹¤í–‰ëœ ì¿¼ë¦¬ë“¤ì€ **ëª¨ë‘** ì„±ê³µí•´ì„œ commitë˜ê±°ë‚˜, ë¬¸ì œê°€ ë°œìƒí•œë‹¤ë©´ rollbackì„ í†µí•´ **ëª¨ë‘** ì·¨ì†Œë˜ì•¼ í•œë‹¤. ì‹¤í–‰ ì¿¼ë¦¬ ì¤‘ ì¼ë¶€ë¶„ë§Œ ì„±ê³µí•  ìˆ˜ ì—†ë‹¤.

##### ì›ìì„± ë³´ì¥

- íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìˆ˜ì •í•  ë•Œ, í•´ë‹¹ ì‹œì ê¹Œì§€ì˜ ì„±ê³µì ì¸ ìƒíƒœê°€ ë¡¤ë°± ì´ë¯¸ì§€ë¡œ ë¡¤ë°± ì„¸ê·¸ë¨¼íŠ¸ë¼ëŠ” ì„ì‹œ ì˜ì—­ì— ì €ì¥ëœë‹¤.

- ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì—¬ ë¡¤ë°±ì´ ë°œìƒí•œë‹¤ë©´, ë¡¤ë°± ì„¸ê·¸ë¨¼íŠ¸ ë‚´ì˜ ìƒíƒœë¡œ ì›ìƒ ë³µêµ¬ëœë‹¤.

- íŠ¸ëœì­ì…˜ì„ commití•œ í›„ì—ëŠ” DBì— ìˆ˜ì •ì‚¬í•­ì´ ì˜êµ¬ì ìœ¼ë¡œ ë°˜ì˜ë¨ìœ¼ë¡œ ë¡¤ë°± ì„¸ê·¸ë¨¼íŠ¸ì˜ ë¡¤ë°± ì´ë¯¸ì§€ëŠ” ì‚­ì œëœë‹¤.

- ì•„ì£¼ ë§ì€ ì¿¼ë¦¬ê°€ ì‹¤í–‰ë˜ëŠ” íŠ¸ëœì­ì…˜ ë²”ìœ„ë‚´ì—ì„œ ëŒ€ë¶€ë¶„ì˜ ë¡œì§ì´ ì„±ê³µì ìœ¼ë¡œ ìˆ˜í–‰ëëŠ”ë°, ë§ˆì§€ë§‰ì— ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì—¬ ë¡¤ë°±ë˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤ê³  í•˜ì. ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•Šì€ ì˜ì—­ê¹Œì§€ ë°˜ë³µì ìœ¼ë¡œ ìˆ˜í–‰í•˜ëŠ” ê±´ ë¹„íš¨ìœ¨ì ì´ë¯€ë¡œ ì„±ê³µì ì¸ ì§€ì ê¹Œì§€ **savePoint**ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

##### savePoint

- íŠ¸ëœì­ì…˜ ë‚´ë¶€ì—ì„œ ì‚¬ìš©ìê°€ ì§€ì •í•  ìˆ˜ ìˆëŠ” ì„¸ë¶€ ì‘ì—… ë‹¨ìœ„

- íŠ¸ëœì­ì…˜ ì‹¤í–‰ê³¼ì •ì—ì„œ íŠ¹ì • ì§€ì ì„ savePointë¥¼ ì„¤ì •í•œ í›„ í•´ë‹¹ ì§€ì ìœ¼ë¡œ ë‚´ë¶€ì ìœ¼ë¡œ ë¡¤ë°± í•  ìˆ˜ ìˆë‹¤.

- íŠ¹ì • savePoint ë¡œ ë¡¤ë°±í•œ ë’¤ì—ëŠ” ì´í›„ì˜ savePointë“¤ì€ ì‚­ì œëœë‹¤.

#### ì¼ê´€ì„±(Consistency)

- ëª¨ë“  íŠ¸ëœì­ì…˜ì€ ì¼ê´€ì„±ìˆëŠ” ë°ì´í„°ë² ì´ìŠ¤ ìƒíƒœë¥¼ ìœ ì§€í•´ì•¼ í•œë‹¤.

- íŠ¸ëœì­ì…˜ ì „ í›„ì˜ ë°ì´í„°ë² ì´ìŠ¤ì˜ ìƒíƒœëŠ” **Correct State**ì—¬ì•¼ í•œë‹¤.
  
  - Correct State : ë„ë©”ì¸ì˜ ìœ íš¨ë²”ìœ„, ë¬´ê²°ì„± ì œì•½ì¡°ê±´ ë“±ì˜ ì œì•½ì¡°ê±´ì„ ìœ„ë°°í•˜ì§€ ì•ŠëŠ” ì •ìƒì ì¸ ìƒíƒœ.
  
  - Cë¼ëŠ” ì»¬ëŸ¼ì˜ ë°ì´í„° íƒ€ì…ì´ ì •ìˆ˜í˜•ì´ë¼ë©´ íŠ¸ëœì­ì…˜ ì´í›„ì—ë„ ì •ìˆ˜í˜•ìœ¼ë¡œ ìœ ì§€ë˜ì•¼ í•œë‹¤.

#### ê²©ë¦¬ì„±(Isolation)

- ê°ê°ì˜ íŠ¸ëœì­ì…˜ì€ ì„œë¡œ ê°„ì„­ì—†ì´ ë…ë¦½ì ìœ¼ë¡œ ìˆ˜í–‰ë˜ì–´ì•¼ í•œë‹¤.

- íŠ¸ëœì­ì…˜ì€ ê¸°ë³¸ì ìœ¼ë¡œ ì›ì¥ì„±, ì¼ê´€ì„± ê·¸ë¦¬ê³  ì§€ì†ì„±ì„ ë³´ì¥í•œë‹¤. í•˜ì§€ë§Œ ê²©ë¦¬ì„±ì„ ì™„ì „íˆ ë³´ì¥í•˜ê¸° ìœ„í•´ì„œëŠ” ê°ê°ì˜ íŠ¸ëœì­ì…˜ì„ ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬í•´ì•¼ í•œë‹¤.

- ì´ëŸ¬í•œ íŠ¹ì„±ì€ ë™ì‹œì„± ì²˜ë¦¬ ì„±ëŠ¥ì„ ë§¤ìš° ë‚˜ì˜ê²Œ í•œë‹¤. ë”°ë¼ì„œ ê²©ë¦¬ì„±ì˜ ìˆ˜ì¤€ì„ ì—¬ëŸ¬ ë‹¨ê³„ë¡œ ë‚˜ëˆˆë‹¤.

##### ê²©ë¦¬ì„±ì˜ ìˆ˜ì¤€

###### READ UNCOMMITED

- ìƒëŒ€ë°©ì— ì»¤ë°‹í•˜ì§€ ì•Šì€ ë°ì´í„°ë¥¼ ì½ì„ ìˆ˜ ìˆë‹¤. ì‚¬ìš©ì Aê°€ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ë°ì´í„° Cë¥¼ ìˆ˜ì •í•˜ê³  ìˆì„ë•Œ, ì‚¬ìš©ì Bê°€ ìˆ˜ì • ì¤‘ì¸ ë°ì´í„° Cë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤, ì»¤ë°‹ë˜ì§€ ì•Šì€ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ëŠ” ê±¸ Â Dirty Readë¼ê³  í•œë‹¤, ì´ë•Œ ì‚¬ìš©ì Bê°€ ë°ì´í„° Cë¥¼ ì‚¬ìš©í•˜ëŠ” ë„ì¤‘ì— ì‚¬ìš©ì Aê°€ ë°ì´í„° Cë¥¼ ë¡¤ë°±í•˜ë©´ ë°ì´í„° ì •í•©ì„±ì´ ê¹¨ì§ˆ ìˆ˜ ìˆë‹¤.

###### READ COMMITED

- ìƒëŒ€ë°©ì´ ì»¤ë°‹í•œ ë°ì´í„°ë§Œ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤, ë”°ë¼ì„œ [Dirty Read](https://github.com/seho27060/TIL/tree/master/Springboot/220825%20springboot%20%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84)ëŠ” ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤, í•˜ì§€ë§Œ NON-REPEATABLE READê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤. ì‚¬ìš©ì Aê°€ ì»¤ë°‹í•œ ë°ì´í„° Cë¥¼ ì‚¬ìš©ì Bê°€ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ì¡°íšŒí•˜ê³  ìˆì„ë•Œ, ì´í›„ì— ì‚¬ìš©ì Aê°€ ë°ì´í„° Cë¥¼ ìˆ˜ì • í›„ ë‹¤ì‹œ ì»¤ë°‹í•œë‹¤ë©´ ì‚¬ìš©ì BëŠ” ê°™ì€ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ë‹¤ë¥¸ ìƒíƒœì˜ ë°ì´í„° Cë¥¼ ì¡°íšŒí•˜ê²Œ ëœë‹¤.

###### REPEATABLE READ

- í•œë²ˆ ì¡°íšŒí•œ ë°ì´í„°ëŠ” íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ë‹¤ì‹œ ì¡°íšŒí•´ë„ ê°™ì€ ë°ì´í„°ê°€ ë‚˜ì˜¤ëŠ”ê²Œ ë³´ì¥ëœë‹¤. 

- í•˜ì§€ë§Œ PHANTOM READê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ì‚¬ìš©ì Aê°€ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ê²Œì‹œê¸€ë“¤ì„ ì¡°íšŒí• ë•Œ, íŠ¸ëœì­ì…˜ ì¤‘ê°„ì— ì‚¬ìš©ì Bê°€ ìƒˆë¡œìš´ ê²Œì‹œê¸€ Dë¥¼ ì¶”ê°€í•œë‹¤ë©´, ë‹¤ì‹œ ë¦¬ìŠ¤íŠ¸ë¥¼ ì¡°íšŒí–ˆì„ë•Œ ë‚˜ì˜¤ëŠ” ê²°ê³¼ê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆë‹¤.  

###### SERIALBLE

- ê°€ì¥ ì—„ê²©í•œ ìˆ˜ì¤€ì˜ ê²©ë¦¬ì„±ì´ì§€ë§Œ ë™ì‹œì„± ì²˜ë¦¬ì—ëŠ” ë§¤ìš° ì•½í•˜ë‹¤.



- ë°ì´í„°ë² ì´ìŠ¤ë“¤ì€ ë³´í†µ ë™ì‹œì„± ì²˜ë¦¬ê°€ ì¤‘ìš”í•˜ê¸° ë•Œë¬¸ì— **READ COMMITED**ìˆ˜ì¤€ì˜ ê²©ë¦¬ì„±ì„ ì‚¬ìš©í•œë‹¤.

#### ì§€ì†ì„±(Durability)

- ì„±ê³µì ìœ¼ë¡œ ìˆ˜í–‰ëœ íŠ¸ëœì­ì…˜ì€ ì˜ì›íˆ ê¸°ë¡ëœë‹¤. ì¤‘ê°„ì— ì‹œìŠ¤í…œ ë¬¸ì œê°€ ë°œìƒí–ˆì„ë•Œ, ë°ì´í„°ë² ì´ìŠ¤ ë¡œê·¸ë¥¼ ì°¸ê³ í•´ì„œ ì„±ê³µí–ˆë˜ íŠ¸ëœì­ì…˜ì„ ë³µêµ¬ í•  ìˆ˜ ìˆë‹¤.

---

- ë ˆí¼ëŸ°ìŠ¤


> [íŠ¸ëœì­ì…˜ - í•´ì‹œë„·](http://wiki.hash.kr/index.php/%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98)[íŠ¸ëœì­ì…˜ - í•´ì‹œë„·](http://wiki.hash.kr/index.php/%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98)
> 
> [[Database] íŠ¸ëœì­ì…˜ì´ë€? â€” ê¹Šê²Œ ìë¼ê¸°](https://devjem.tistory.com/27#%EC%-B%--%EC%-E%--%EC%--%B--Automicity-)
> 
> [DB íŠ¸ëœì­ì…˜(Transaction) | ğŸ‘¨ğŸ»â€ğŸ’» Tech Interview](https://gyoogle.dev/blog/computer-science/data-base/Transaction.html)
