[TOC]

# Linux

## Crontab

- Window의 스케줄러와 같이 사전에 설정한 시간에 원하는 작업을 수행하는 작업 스케줄링이 가능한 유틸리티 프로그램

- `Crontab`에 시간과 실행할 `shell script`를 설정하여 해당 시간에 원하는 `shell script`를 실행할 수 있다.
  
  - 주기적으로 `DB`의 특정 조건의 데이터를 삭제한다면, `shell script`상에서 `DB`에 접속하여 삭제 작업을 수행하거나
  
  - `.js`, `.py`과 같은 언어로 스크립트를 작성하여 원하는 작업을 수행할 수 도 있다.

#### 특징

- 작업 간의 최단 간격은 60초

- 한 개 머신에서 개별로 설정한다.

- 자동 재시도 매커니즘이 따로 존재하지 않는다.

=> 스케줄링의 작업이 복잡한 로직이라면 스케줄링을 위한 어플리케이션을 실행하여 자동 재시도 및 복원 기능을 추가하여 안정적으로 운용할 수 도 있겠다.

=> 간단한 작업이라면 `crontab`을, 다소 복잡하다면 `crontab`과 프로그래밍 스크립트 파일을, 재시도 및 복원을 위해서라면 스케줄링 어플리케이션이 적합할 수 있다.

=> 업무 중에 어플리케이션 내부에서 `node-schedule`을 통한 스케줄링인지.. `crontab`을 통한 스케줄링인지 결정해야할 기로에 있었는데. 개발이 항상 그렇듯 정답은 없고 최적화 방안에 대한 고려가 필수적이였다.

### 사용법

#### 크론탭 기본

- ```bash
  crontab -e
  ```
  
  리눅스 쉘에서 위와 같은 명령어를 입력하면 크론탭의 작업(시간과 실행 `.sh` 파일)을 설정할 수 있는 편집기가 로딩된다.
  
  - ```bash
    * * * * * ls -al
    ```
    
    위와 같은 형식으로 설정한다.(예시는 매순간 `ls -al`로 디렉토리 목록을 출력한다.의 의미)
  - \*는 앞에서 부터 분(0-59), 시간(0-23), 일(1-31), 월(1-12), 요일(0-7)로 원하는 값을 입력하면 해당 시간에 입력된 명령어가 실행된다.

- `crontab -l`은 크론탭 내용 조회, `crontab -r` 크론탭 삭제 등의 작업을 수행할 수 있다.

#### 크론탭 활용

- 크론탭의 경우 시간을 설정하는 1개의 줄에는 1개의 명령어만 입력이 가능하다. 따라서 `.sh`와 같은 파일에 미리 원하는 `Linux`명령어를 입력하여 여러 작업을 동기적으로 수행할 수도 있다.

- 또는 `.sh`로 `Linux` 터미널에서 설정을 바꾸고, 특정 언어로 작성된 스크립트 파일을 수행하여 보다 복잡한 작업을 한번에 수행할 수 도 있다.

- 그 보다 더\~ 복잡한 작업을 하고 싶다면, 어플리케이션 내부에서 스케줄링 라이브러리를 활용하는 것도 하나의 방법이다.

---

- 레퍼런스

> [리눅스 크론탭(Linux Crontab) 사용법 :: JDM's Blog](https://jdm.kr/blog/2)
> 
> [crontab 사용법 알아보기 (크론탭, 옵션, 스케쥴러 예제, 샘플)](https://iamfreeman.tistory.com/entry/crontab-%EC%82%AC%EC%9A%A9%EB%B2%95-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0-%ED%81%AC%EB%A1%A0%ED%83%AD-%EC%98%B5%EC%85%98-%EC%8A%A4%EC%BC%80%EC%A5%B4%EB%9F%AC)
