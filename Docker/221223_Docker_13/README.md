[TOC]

# Docker 13

## Docker & 컨테이너 - 요약

#### 이미지 & 컨테이너

- 컨테이너
  
  - 공유와 재생산이 쉬운 패키지형태
  
  - 격리된 환경
  
  - 하나의 작업에 집중됨
  
  - Stateless

- 이미지
  
  - 컨테이너의 블루프린트
  
  - 같은 이미지로 서로 다른 컨테이너를 생성할 수 있다.(객체 - 인스턴스?)
  
  - 소스코드와 환경을 담고 있다.
    
    - 레이어로 구성되어 있으며, 각 레이어는 1개의 소스코드 명령어로 캐싱되어 관리된다.
  
  - Read-only 형태
  
  - 빌드가 가능하며, 공유가 가능하다.

#### 주요 명령

- `docker build -t NAME:TAG` - 소스코드, 환경을 이미지로 빌드한다.

- `docker run --name NAME --rm -d IMAGE` - 이미지를 컨테이너로 실행한다.

- `docker push REPOSITORY/NAME:TAG`, `docker pull REPOSITORY:TAG` -  dockerhub의 repository에 이미지를 push하여 업로드하거나, pull하여 다운로드한다.

#### 데이터, 볼륨 및 네트워킹

- 컨테이너에서 관리되는 데이터들은 기본적으로 모두 휘발성이다.
  
  - 컨테이너 재시작, 종료시 데이터 보존이 안됨

- 바인드 마운트, 볼륨을 통해 해결한다.
  
  - 바인드 마운트 : 로컬 영구 저장소
  
  - 볼륨 : 로컬 임시 저장소

- 네트워킹
  
  - 같은 머신에서 실행하는 컨테이너들은 공동 네트워크 내에서 컨테이너 이름을 통해 컨테이너 간 접근이 가능하다.

#### Docker vs Docker Compose

- Docker를 활용하여 다중 컨테이너를 실행시, 각각의 컨테이너의 설정과 반복적인 명령어로 인해 생산성이 떨어진다.

- Docker Compose는 반복적인 과정을 줄이고, 모든 컨테이너들을 일괄적으로 관리하여 다중 컨테이너 실행에 용이하게 한다.

#### 개발 환경 vs 배포 환경

#### Deployment

- 배포시에는 바인드 마운트를 실행하지 않고 볼륨이나 `COPY` 명령어로 대체한다.

- 로컬에서는 모든 컨테이너는 동일한 머신에서 작동하지만, 클라우드를 활용한 배포환경에서는 같은 컨테이너를 실행해도 서로 다른 머신(호스트)에서 작동할 수 있음을 유의한다.(접근 ip가 달라질 수 있음)

- 멀티 스테이지 빌드
  
  - 모든 컨테이너의 모든 설정과 환경을 조정하고 모니터링해야함
  
  - 직접 모든걸 관리하는것과 간편한 기능을 제공하는 관리형 서비스를 사용하는 것 중 상황과 조건을 고려하여 선택하자.

---

- 레퍼런스

> [Udemy - Docker & Kubernetes : 실전 가이드](https://www.udemy.com/course/docker-kubernetes-2022/)
